class GlozinStoreLocationsWidgetHandler extends elementorModules.frontend.handlers.Base{getDefaultSettings(){return{selectors:{content:".glozin-store-locations__content",embed:".glozin-store-locations__embed",mapbox:".glozin-store-locations__mapbox"}}}getDefaultElements(){const e=this.getSettings("selectors");return{$content:this.findElement(e.content),$embed:this.findElement(e.embed),$mapbox:this.findElement(e.mapbox)}}changeActiveTab(e){const t=this.elements.$content.filter('[data-tab="'+e+'"]'),o=this.elements.$embed.filter('[data-tab="'+e+'"]'),n=t.hasClass("active");if(n){return}t.addClass("active").siblings(".active").removeClass("active");o.addClass("active").siblings(".active").removeClass("active")}bindEvents(){this.elements.$content.on({click:e=>{e.preventDefault();this.changeActiveTab(e.currentTarget.getAttribute("data-tab"))}})}get_coordinates(){var i=[],s=0,l=this,c=l.elements.$mapbox,d=c.data("map"),e=d.local,t=mapboxSdk({accessToken:d.token}),m=c.find(".glozin-map__content").attr("id");mapboxgl.accessToken=d.token;var o=Array.isArray(e)?e:[e];var n=o.map((e,r)=>{return t.geocoding.forwardGeocode({query:e,autocomplete:false,limit:1}).send().then(e=>{if(e&&e.body&&e.body.features&&e.body.features.length){var t=e.body.features[0],o=c.find(".glozin-store-locations__info");o.eq(r).attr("data-latitude",t.center[0]);o.eq(r).attr("data-longitude",t.center[1]);var n={type:"Feature",properties:{description:o.eq(r).html(),icon:"theatre"},geometry:{type:"Point",coordinates:[t.center[0],t.center[1]]}};if(s===0){var a=[t.center[0],t.center[1]];l.get_map(m,d,o,d.token,i,a)}i.push(n);s++}})});return Promise.all(n).then(()=>i)}get_map(e,o,t,n,a,r){var i=new mapboxgl.Map({container:e,style:"mapbox://styles/mapbox/"+o.mode,center:r,zoom:o.zom});var s=new MapboxGeocoder({accessToken:mapboxgl.accessToken});i.addControl(s);i.on("load",function(){i.loadImage(o.marker,function(e,t){if(e)throw e;i.addImage("marker",t);i.addLayer({id:"points",type:"symbol",source:{type:"geojson",data:{type:"FeatureCollection",features:a}},layout:{"icon-image":"marker","icon-size":1}})});i.addSource("single-point",{type:"geojson",data:{type:"FeatureCollection",features:[]}});i.addLayer({id:"point",source:"single-point",type:"circle",paint:{"circle-radius":10,"circle-color":"#007cbf"}});i.setPaintProperty("water","fill-color",o.color_1);i.setPaintProperty("building","fill-color",o.color_2);s.on("result",function(e){i.getSource("single-point").setData(e.result.geometry)});i.on("click","points",function(e){var t=e.features[0].geometry.coordinates.slice();var o=e.features[0].properties.description;while(Math.abs(e.lngLat.lng-t[0])>180){t[0]+=e.lngLat.lng>t[0]?360:-360}(new mapboxgl.Popup).setLngLat(t).setHTML(o).addTo(i)});i.on("mouseenter","points",function(){i.getCanvas().style.cursor="pointer"});i.on("mouseleave","points",function(){i.getCanvas().style.cursor=""})});t.on("click",function(){var e=jQuery(this).data("latitude"),t=jQuery(this).data("longitude");i.flyTo({center:[e,t],zoom:o.zom,essential:true,speed:3,curve:1})})}onInit(...e){super.onInit(...e);this.get_coordinates()}}jQuery(window).on("elementor/frontend/init",()=>{elementorFrontend.hooks.addAction("frontend/element_ready/glozin-store-locations.default",e=>{elementorFrontend.elementsHandler.addHandler(GlozinStoreLocationsWidgetHandler,{$element:e})})});