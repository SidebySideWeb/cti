(function(m){"use strict";var a=null;function e(){m("#glozin-customer-reviews-files").on("change",function(){m(".glozin-customer-reviews__items").empty();m(".glozin-customer-reviews__message").removeClass("error");m(".glozin-customer-reviews__message").text(glozinCRA.message);let s=["image/jpeg","image/png","image/jpg","image/gif"];if(glozinCRA.upload_video){s=["image/jpeg","image/png","image/jpg","image/gif","video/mp4","video/mpeg","video/ogg","video/webm","video/quicktime","video/x-msvideo"]}let t=m("#glozin-customer-reviews-files");var r=glozinCRA.error,e=glozinCRA.label,i=false;if(a){const n=new DataTransfer;for(let e=0;e<a.length;e++){n.items.add(a[e])}for(let e=0;e<t[0].files.length;e++){n.items.add(t[0].files[e])}if(n.files.length>glozinCRA.limit){m(".glozin-customer-reviews__message").addClass("error");m(".glozin-customer-reviews__message").text(r.too_many);t[0].files=a}else{t[0].files=n.files;if(m(this).closest(".glozin-customer-reviews").find(".glozin-customer-reviews__message").hasClass("error")){m(this).closest(".glozin-customer-reviews").find(".glozin-customer-reviews__message").removeClass("error");m(this).closest(".glozin-customer-reviews").find(".glozin-customer-reviews__message").text(e)}for(let e=0;e<n.files.length;e++){if(!s.includes(n.files[e].type)){m(".glozin-customer-reviews__message").addClass("error");m(".glozin-customer-reviews__message").text(r.file_type);i=true;break}if(n.files[e].size&&n.files[e].size>glozinCRA.size){m(".glozin-customer-reviews__message").addClass("error");m(".glozin-customer-reviews__message").text(r.file_size);i=true;break}}if(i){t[0].files=a}else{a=t[0].files}}}else{a=t[0].files}let o=t[0].files.length;let l=m(".glozin-customer-reviews__items .glozin-customer-reviews__item").length;if(o+l>glozinCRA.limit){m(".glozin-customer-reviews__message").addClass("error");m(".glozin-customer-reviews__message").text(r.too_many);m(".glozin-customer-reviews__items .glozin-customer-reviews__item").not(".uploaded").remove();t.val("");return}for(let i=0;i<o;i++){if(!s.includes(t[0].files[i].type)){m(".glozin-customer-reviews__message").addClass("error");m(".glozin-customer-reviews__message").text(r.file_type);m(".glozin-customer-reviews__items .glozin-customer-reviews__item").not(".uploaded").remove();t.val("");return}else if(t[0].files[i].size&&t[0].files[i].size>glozinCRA.size){m(".glozin-customer-reviews__message").addClass("error");m(".glozin-customer-reviews__message").text(r.file_size);m(".glozin-customer-reviews__items .glozin-customer-reviews__item").not(".uploaded").remove();t.val("");return}else{if(-1===t[0].files[i].type.indexOf("image")&&!glozinCRA.upload_video){continue}let e=m("<div/>",{class:"glozin-customer-reviews__item"});if(-1===t[0].files[i].type.indexOf("image")){e.append(m("<img>",{id:"image-preview-"+i,src:m(this).closest(".glozin-customer-reviews").find('[name="thumbnail_url"]').val()}));e.append('<span class="glozin-svg-icon glozin-svg-icon--play glozin-customer-reviews__play"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="21" viewBox="0 0 18 21" fill="currentColor"><path d="M18 10.5L0.749999 20.4593L0.75 0.540707L18 10.5Z" fill="currentColor"></path></svg></span>')}else{e.append(m("<img>",{id:"image-preview-"+i}));g(t[0].files,i)}e.append('<div class="glozin-customer-reviews__bg"></div><span class="glozin-svg-icon glozin-svg-icon--close glozin-customer-reviews__delete"><svg aria-hidden="true" role="img" focusable="false" fill="currentColor" width="16" height="16" viewBox="0 0 16 16"><path d="M16 1.4L14.6 0L8 6.6L1.4 0L0 1.4L6.6 8L0 14.6L1.4 16L8 9.4L14.6 16L16 14.6L9.4 8L16 1.4Z" fill="currentColor"></path></svg></span>');m(".glozin-customer-reviews__items").append(e)}}})}function i(){m(".glozin-customer-reviews__items").on("click",".glozin-customer-reviews__delete, .glozin-customer-reviews__bg",function(){var i=m(this).closest(".glozin-customer-reviews").find("#glozin-customer-reviews-files")[0],s=m(this).closest(".glozin-customer-reviews__item").index(),e=m(this).closest(".glozin-customer-reviews").find(".glozin-customer-reviews__message"),t=glozinCRA.label;if(!i.files||!i.files[s]){return false}const r=new DataTransfer;for(let e=0;e<i.files.length;e++){if(i.files[e].name!==i.files[s].name){r.items.add(i.files[e])}}if(r.files){i.files=r.files;a=i.files;m(this).closest(".glozin-customer-reviews__item").remove();if(e.hasClass("error")){e.removeClass("error");e.text(t)}}})}function g(e,i){var s=new FileReader;s.readAsDataURL(e[i]);s.onload=function(e){document.getElementById("image-preview-"+i).src=e.target.result}}function s(){m(".glozin-customer-reviews__attachment").on("click","a",function(e){e.preventDefault();var i=m(".pswp")[0],s=l(m(this).closest(".glozin-customer-reviews__attachments").find(".glozin-customer-reviews__attachment")),t=m(this).closest(".glozin-customer-reviews__attachment").index();var r=m.extend({index:t,addCaptionHTMLFn:function(e,i){if(!e.title){i.children[0].textContent="";return false}i.children[0].textContent=e.title;return true}},wc_single_product_params.photoswipe_options);var o=new PhotoSwipe(i,PhotoSwipeUI_Default,s,r);o.init();return false})}function l(e){var g=[];if(e.length>0){e.each(function(e,i){if(m(i).data("type")=="image"){var s=m(i).find("img");if(s.length){var t=s.attr("src"),r=s.attr("width"),o=s.attr("height"),l=s.attr("alt"),n={alt:l,src:t,w:r,h:o,title:s.attr("data-caption")?s.attr("data-caption"):s.attr("title")};g.push(n)}}else{var a=m(i).find("a").attr("href");if(a.length){var n={html:'<div class="pswp__video"><video width="960" src="'+a+'" controls></video></div>'};g.push(n)}}})}return g}m(function(){if(typeof glozinCRA==="undefined"){return false}m("#commentform").attr("enctype","multipart/form-data");e();i();s()})})(jQuery);