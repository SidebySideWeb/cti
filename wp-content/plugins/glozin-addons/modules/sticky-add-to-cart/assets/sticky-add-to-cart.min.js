(function(g){"use strict";var i=i||{};i.init=function(){this.stickyAddToCart();this.addToCartFormScroll();this.changeAttributesData();g(document.body).on("glozin_off_canvas_closed glozin_modal_closed glozin_popover_closed",function(t){i.stickyAddToCart()})};i.stickyAddToCart=function(){var i=g("#glozin-sticky-add-to-cart");if(!i.length){return}var o=0;if(g(document.body).hasClass("admin-bar")){o+=32}function t(){if(!g("div.product").find("form.cart").length){return}var t=g("div.product").find("form.cart").offset().top+g("div.product").find("form.cart").outerHeight()-o;if(window.scrollY>t){i.addClass("open");g(document.body).addClass("glozin-atc-sticky-height-open")}else{i.removeClass("open");g(document.body).removeClass("glozin-atc-sticky-height-open")}}g(window).on("scroll",function(){t()});g(window).on("resize",function(){var t=i.height();if(g(document.body).find("div.product").hasClass("outofstock")){t=0}g(document.body).css("--gz-atc-sticky-height",t+"px")}).trigger("resize")};i.addToCartFormScroll=function(){g("#glozin-sticky-add-to-cart").on("click",".gz-add-to-cart-options",function(t){t.preventDefault();g("html,body").stop().animate({scrollTop:g("div.product").find("form.cart").offset().top-50},"slow")})};i.changeAttributesData=function(){var d=g("#glozin-sticky-add-to-cart");var c=g("div.product").find("form.cart");if(!d.length){return}var s=d.find(".glozin-sticky-atc__image img"),f=d.find(".single_add_to_cart_button"),l=f.text(),u=false;d.find(".glozin-sticky-atc__variations").on("change","select",function(t){var i=g("option:selected",this),o=i.data("image"),a=i.data("attributes"),n=i.data("stock");if(a!==undefined){f.removeClass("disabled");for(var e in a){d.find("form.cart").find('input[name="'+e+'"]').val(a[e]);if(u){continue}u=true;var r=c.find('select[name="'+e+'"]');if(r.length>0){r.val(a[e]).trigger("change")}u=false}}else{f.addClass("disabled")}if(n){if(n.stock=="out_of_stock"){f.addClass("disabled")}f.text(n.button_text)}else{f.text(l)}if(o===undefined){o=s.data("o_src")}s.attr("src",o)});var o=d.find(".glozin-sticky-atc__variations").find('select[name="variation_id"]');c.on("found_variation",function(t,i){if(u)return;var r=i.attributes;var d=null;var c=0;var s=-1;o.find("option").each(function(t){var i=g(this);var o=i.val();if(!o||o==="")return;var a=i.data("attributes");if(typeof a==="string"){try{a=JSON.parse(a)}catch(t){a={}}}if(!a||typeof a!=="object")return;var n=0;var e=0;g.each(r,function(t,i){e++;if(a[t]===i){n++}});if(n===e&&e>0){d=i;c=n;s=t;return false}if(n>c){c=n;d=i;s=t}});if(d&&c>0){u=true;o[0].selectedIndex=s;o.trigger("change");u=false}})};g(function(){i.init();g("#glozin-sticky-add-to-cart").find(".glozin-sticky-atc__variations select").trigger("change")})})(jQuery);